
<%#= render "layouts/alerts" %>

<h1><%= @client.full_name %></h1>
<h3>Contact Info:</h3>
<h4><%= @client.address.titleize %></h4>
<h4>Home Phone: <%= @client.home_phone %></h4>
<h4>Cell Phone: <%= @client.cell_phone %></h4>
<h3>Demographics:</h3>
<h4>Race: <%= @client.race %>
<h4>Sex: <%= @client.sex %></h4>

<%= form_tag "/clients/#{@client.id}", method: :post do %>
  <div>
    <%= label_tag :Notes %>
    <%= text_area_tag :description %>
  </div>
  <div>
    <%= submit_tag "Submit Note" %>
  </div>
<% end %>

<h4> Counselor Notes: <% @client_notes.each do |note|%></h4>
<h3><%= note.description %></h3>
<h5><%= note.pretty_time %></h5>
<%= link_to "edit", notes_edit_path(note.id) %>
<%= button_to "delete", client_path(:id => note.id), :method => :delete %>
<% end %>

<h4>Housing Application</h4>

  <table class="table table-hover">
  <thead>
    <th colspan="2"><h3>Homebuying Counseling  Information:</h3></th>
  </thead>
  <tbody>
    <tr>
      <td>Lender</td>
      <td><%= best_in_place @client.homebuying, :lender, :class=>"best_in_place" %></td>      
    </tr>
    <tr>
      <td>Would you Like to be contacted for an appointment</td>
      <td><%= best_in_place @client.homebuying, :contact_for_appointment, :class=>"best_in_place", as: :checkbox, collection: {false: "No", true: "Yes"} %></td>     
    </tr>
    <tr>
      <td>Have you signed a real estate contract yet?</td>
      <td><%= best_in_place @client.homebuying, :real_estate_contract, as: :checkbox, collection: {false: "No", true: "Yes"}, :class=>"best_in_place" %></td>      
    </tr>
    <tr>
      <td>What is your realtor's name?</td>
      <td><%= best_in_place @client.homebuying, :realtor_name, :class=>"best_in_place" %></td>     
    </tr>
    <tr>
      <td>Realtor's phone number</td>
      <td><%= best_in_place @client.homebuying, :realtor_phone, :class=>"best_in_place" %></td>
    </tr>
    <tr>
      <td>What is the address of the property you are looking to purchase?</td>
      <td><%= best_in_place @client.homebuying, :property_address, :class=>"best_in_place" %></td>     
    </tr>
    <tr>
      <td>City</td>
      <td><%= best_in_place @client.homebuying, :property_city, :class=>"best_in_place" %></td>
    </tr>
    <tr>
      <td>State</td>
      <td><%= best_in_place @client.homebuying, :property_state, :class=>"best_in_place", :as => :select, :collection => us_states %></td> 
    </tr>
    <tr>
      <td>What is your loan officer's name?</td>
      <td><%= best_in_place @client.homebuying, :loan_officer_name, :class=>"best_in_place" %></td>      
    </tr>
    <tr>
      <td>loan officer's email</td>
      <td><%= best_in_place @client.homebuying, :loan_officer_email, :class=>"best_in_place" %></td>     
    </tr>
    <tr>
      <td>loan officer's phone number</td>
      <td><%= best_in_place @client.homebuying, :loan_officer_phone, :display_with => :number_to_phone, :class=>"best_in_place" %></td>  
    </tr>
    <tr>
      <td>What kind of payment assistance program will you be using?</td>
      <td><%= best_in_place @client.homebuying, :payment_assistance_program, :as => :select, :class=>"best_in_place", :collection => down_payment_assistance_program %></td>     
    </tr>
    <tr>
      <td>What is the approximate closing date? </td>
      <td><%= best_in_place @client.homebuying, :approx_closing_date, :as => :date, :class=>"best_in_place" %></td>      
    </tr>
    <tr>
      <td>How did you hear of the workshop</td>
      <td><%= best_in_place @client.homebuying, :hear_of_workshop %></td>
    </tr>
  </tbody>
</table>

<h4>Foreclosure Application</h4>

<table class="table table-hover">
    <thead>
      <th colspan="2"><h3>Foreclosure Application:</h3></th>
    </thead>

  <tbody>
    <tr>
      <td>Are you currently going through foreclosure?</td>   
      <td><%= best_in_place @client.foreclosure, :currently_foreclosed, :as => :select, :class=>"best_in_place", :collection => foreclosure_status  %></td>
    </tr>
    <tr>
      <td>Who is your originating lender?</td>    
      <td><%= best_in_place @client.foreclosure, :originating_lender %></td>
    </tr>
    <tr>
      <td>What is your loan number?</td>    
      <td><%= best_in_place @client.foreclosure, :original_loan_number %></td>
    </tr>
    <tr>
      <td>Who is your servicer?</td>    
      <td><%= best_in_place @client.foreclosure, :servicer %></td>
    </tr>
    <tr>
      <td>What is the servicer loan number?</td>
      <td><%= best_in_place @client.foreclosure, :servicer_loan_number %></td>
    </tr>
    <tr>
      <td>Monthly Mortgage Payment:</td>    
      <td><%= best_in_place @client.foreclosure, :monthly_mortgage_payment, :display_with => :number_to_currency %></td>
    </tr>
    <tr>
      <td>Loan origination date:</td>   
      <td><%= best_in_place @client.foreclosure, :origination_date, :as => :date %></td>
    </tr>
    <tr>
      <td>Have you been to court?</td>    
      <td><%= best_in_place @client.foreclosure, :been_to_court, as: :select, collection: {false: "No", true: "Yes"} %></td>
    </tr>
    <tr>
      <td>What is your court case number?</td>    
      <td><%= best_in_place @client.foreclosure, :court_case_number %></td>
    </tr>
    <tr>
      <td>Are you working with a lawyer?</td>   
      <td><%= best_in_place @client.foreclosure, :working_with_lawyer, as: :select, collection: {false: "No", true: "Yes"} %></td>
    </tr> 
    <tr>
      <td>Are you working with another HUD approved agency?</td>    
      <td><%= best_in_place @client.foreclosure, :working_w_agency, as: :select, collection: {false: "No", true: "Yes"} %></td>
    </tr>

    <tr>
      <td>What is the reason for your default?</td>   
      <td><%= best_in_place @client.foreclosure, :reason_for_default, :as => :select, :class=>"best_in_place", :collection => cause_for_default %></td>
    </tr>
  </tbody>
</table>

<% if current_user.id != @client.user_id %>
  
  <%= form_tag("/clients_assign/#{@client.id}", method: :patch) do %>
    <div class = "field">
      <%= collection_select(:program_employee, :user_id, User.all, :id, :full_name, {:prompt => 'Select a Counselor'}) %>
      </div>
      <%= hidden_field_tag :client_id, @client.id %>
      <%# if !@client.foreclosure.blank? %>
        <%#= hidden_field_tag :programable_id, @client.foreclosure.id %>
        <%#= hidden_field_tag :programable_type, "Foreclosures" %>
    <%# elsif !@client.homebuying.blank? %>   
        <%#= hidden_field_tag :programable_id, @client.homebuying.id %>
        <%#= hidden_field_tag :programable_type, "Homebuyings" %>       
    <%# elsif !@client.rental.blank? %>
        <%#= hidden_field_tag :programable_id, @client.rental.id %>
        <%#= hidden_field_tag :programable_type, "Rentals" %>
    <%# elsif !@client.senior_repair.blank? %>
        <%#= hidden_field_tag :programable_id, @client.senior_repair.id %>
        <%#= hidden_field_tag :programable_type, "SeniorRepairs" %>
    <%# elsif !@client.law_project.blank? %>
        <%#= hidden_field_tag :programable_id, @client.law_project.id %>
        <%#= hidden_field_tag :programable_type, "LawProjects" %>
    <%# end %>
      <%= submit_tag "Assign" %>

  <% end %>



<% end %>